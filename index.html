<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dystopian Future Token Exchange</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-image: url("https://static.wixstatic.com/media/c837a6_3f53cdbff83b47b19a97bd35c767333c~mv2.jpg/v1/fill/w_3584,h_1780,al_c,q_90,usm_0.66_1.00_0.01,enc_avif,quality_auto/c837a6_3f53cdbff83b47b19a97bd35c767333c~mv2.jpg");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        height: 100vh;
        font-family: "Poppins", sans-serif;
      }
    </style>
    <style>
      .header {
        background: #111;
        display: flex;
        align-items: center;
        padding: 10px 20px;
        height: 60px;
      }

      .header-text {
        font-family: barlow-medium, barlow, sans-serif;
        font-feature-settings: normal;
        font-kerning: auto;
        font-optical-sizing: auto;
        font-size: 24px;
        font-size-adjust: none;
        font-weight: 400;
      }

      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
        color: white;
        font-size: 22px;
        font-weight: bold;
        gap: 10px;
      }

      .logo svg {
        height: 40px;
        width: auto;
      }

      .symbol {
        color: #666;
        font-weight: 400;
      }
    </style>
    <style>
      .input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: auto;
        height: 100vh;
      }

      .exchange-rate {
        color: #833b47;
        text-align: center;
        margin-bottom: 0px;
        font-family: "Poppins", sans-serif;
        padding: 5px;
      }

      .exchange-rate-value {
        color: #6d2e3a;
        font-size: 18px;
        font-weight: bold;
        color: #e0bfb8;
        text-align: center;
        font-family: "Poppins", sans-serif;
        margin-bottom: 55px;
        padding: 5px;
      }

      input {
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: rgba(255, 255, 255, 0.7);
        color: #333;
        font-size: 16px;
        margin-bottom: 20px;
      }

      #ownerUI {
        margin-top: 10vh;
        gap: 15px;
      }

      button {
        padding: 10px 15px;
        background: #8b2e3c;
        color: white;
        border: 2px solid #a13d4b;
        font-size: 16px;
        cursor: pointer;
        border-radius: 5px;
      }

      button:hover {
        background: #b71c3d;
      }

      #error-container {
        display: none;
        margin-top: 10px;
      }

      .error-message {
        display: inline-block;
        background-color: #6d2e3a;
        color: white;
        padding: 10px 15px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.5);
        font-size: 14px;
        max-width: 80%;
        text-align: center;
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.2);
      }

      #checkBalance {
        margin-top: 5vh;
        padding: 10px 20px;
        background: #111;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
        border-radius: 5px;
        border: 2px solid #8b2e3c;
      }

      #checkBalance:hover {
        background: #555;
      }
    </style>
    <header class="header">
      <a href="https://dystopianfuture.wixsite.com/dtfu" class="logo">
        <svg
          width="40"
          height="40"
          viewBox="20.303 25.565 159.393 148.871"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g fill="#FFFFFF">
            <path
              d="M179.398 97.035c-2.089-12.835-17.014-19.402-28.953-14.029l-12.537 5.671c-11.94 5.373-25.371 5.373-37.311 0L88.06 83.006C76.12 77.633 61.196 84.2 59.107 97.035c-.299.895-.299 2.089-.299 3.283 0 .895 0 2.089.299 3.283 2.089 12.835 17.014 19.402 28.953 14.029l12.537-5.671c11.94-5.373 25.371-5.373 37.311 0l12.537 5.671c11.94 5.373 26.864-1.194 28.953-14.029.298-.895.298-2.089.298-3.283 0-.895 0-2.089-.298-3.283z"
            ></path>
            <path
              d="M49.556 62.112l12.537-5.671c11.94-5.373 25.371-5.373 37.311 0l12.537 5.671c11.94 5.373 26.864-1.194 28.953-14.029.298-.895.298-2.089.298-3.283 0-.895 0-2.089-.298-3.283-2.089-12.835-17.014-19.402-28.953-14.029l-12.537 5.671c-11.94 5.373-25.371 5.373-37.311 0l-12.537-5.671c-11.94-5.373-26.864.895-28.953 14.029-.299.895-.299 2.089-.299 3.283 0 .896 0 2.089.299 3.283 2.089 12.835 17.013 19.402 28.953 14.029z"
            ></path>
            <path
              d="M111.94 137.928l-12.537 5.671c-11.94 5.373-25.371 5.373-37.311 0l-12.537-5.671c-11.94-5.373-26.864 1.194-28.953 14.029-.299.895-.299 2.089-.299 3.283 0 .896 0 2.089.299 3.283 2.089 12.835 17.014 19.402 28.953 14.029l12.537-5.671c11.94-5.373 25.371-5.373 37.311 0l12.537 5.671c11.94 5.373 26.864-1.194 28.953-14.029.298-.896.298-2.089.298-3.283 0-.895 0-2.089-.298-3.283-2.089-12.836-17.014-19.402-28.953-14.029z"
            ></path>
          </g>
        </svg>
        <span
          ><div class="header-text">
            Dystopian Future <span class="symbol">DTFU</span>
          </div>
        </span>
      </a>
    </header>
  </head>
  <body>
    <div class="input-container">
      <p class="exchange-rate">Current Exchange Rate:</p>
      <p class="exchange-rate-value">2 POL = 1 DTFU</p>
      <input id="amount" type="number" placeholder="Amount of DTFU" />
      <button id="swapButton" onclick="swapTokens()">Swap POL for Token</button>
      <div id="error-container">
        <p id="status" class="error-message"></p>
      </div>
      <div id="ownerUI" style="display: none">
        <button id="withdrawButton">Withdraw POL</button>
        <div>
          <input
            type="text"
            id="dtfuRecipient"
            placeholder="Recipient Address"
          />
          <input
            type="text"
            id="dtfuAmount"
            placeholder="Amount to transfer DTFU"
          />
          <button id="transferDTFUButton">Transfer DTFU</button>
        </div>
        <div>
          <input
            type="text"
            id="burnAmount"
            placeholder="Enter amount to burn"
          />
          <button id="burnButton" onclick="burnTokens()">Burn Tokens</button>
          <p id="burnStatus"></p>
        </div>
      </div>
      <a href="#" id="checkBalanceUrl">
        <button id="checkBalance">Loading DTFU Balance...</button>
      </a>
      <p id="balanceDisplay" style="color: white; margin-top: 10px"></p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

    <script>
      console.log("Script is running!");
      const swapButton = document.getElementById("swapButton");
      const statusElement = document.getElementById("status");
      const withdrawButton = document.getElementById("withdrawButton");
      const transferDTFUButton = document.getElementById("transferDTFUButton");

      if (typeof ethers !== "undefined") {
        console.log("Ethers.js loaded successfully!");
      } else {
        console.error("Failed to load ethers.js");
      }
      const ownerAddress = "0xe5D5dd7852D70A7a774fe97055b403C7491BBFDE";
      const DTFU_CONTRACT_ADDRESS =
        "0xa7f2b206E8618D5016FFC78c9c1C6D86f6505cB2";
      const DTFU_ABI = [
        {
          inputs: [],
          stateMutability: "nonpayable",
          type: "constructor",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "spender",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "allowance",
              type: "uint256",
            },
            {
              internalType: "uint256",
              name: "needed",
              type: "uint256",
            },
          ],
          name: "ERC20InsufficientAllowance",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "sender",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "balance",
              type: "uint256",
            },
            {
              internalType: "uint256",
              name: "needed",
              type: "uint256",
            },
          ],
          name: "ERC20InsufficientBalance",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "approver",
              type: "address",
            },
          ],
          name: "ERC20InvalidApprover",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "receiver",
              type: "address",
            },
          ],
          name: "ERC20InvalidReceiver",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "sender",
              type: "address",
            },
          ],
          name: "ERC20InvalidSender",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "spender",
              type: "address",
            },
          ],
          name: "ERC20InvalidSpender",
          type: "error",
        },
        {
          inputs: [],
          name: "EnforcedPause",
          type: "error",
        },
        {
          inputs: [],
          name: "ExpectedPause",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "owner",
              type: "address",
            },
          ],
          name: "OwnableInvalidOwner",
          type: "error",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "account",
              type: "address",
            },
          ],
          name: "OwnableUnauthorizedAccount",
          type: "error",
        },
        {
          inputs: [],
          name: "ReentrancyGuardReentrantCall",
          type: "error",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "owner",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "spender",
              type: "address",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "Approval",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "previousOwner",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "newOwner",
              type: "address",
            },
          ],
          name: "OwnershipTransferred",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: false,
              internalType: "address",
              name: "account",
              type: "address",
            },
          ],
          name: "Paused",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "sender",
              type: "address",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "amount",
              type: "uint256",
            },
          ],
          name: "Received",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "user",
              type: "address",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "maticAmount",
              type: "uint256",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "tokenAmount",
              type: "uint256",
            },
          ],
          name: "Swap",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "from",
              type: "address",
            },
            {
              indexed: true,
              internalType: "address",
              name: "to",
              type: "address",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "Transfer",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: false,
              internalType: "address",
              name: "account",
              type: "address",
            },
          ],
          name: "Unpaused",
          type: "event",
        },
        {
          anonymous: false,
          inputs: [
            {
              indexed: true,
              internalType: "address",
              name: "owner",
              type: "address",
            },
            {
              indexed: false,
              internalType: "uint256",
              name: "amount",
              type: "uint256",
            },
          ],
          name: "Withdraw",
          type: "event",
        },
        {
          inputs: [],
          name: "DTFU_PRICE",
          outputs: [
            {
              internalType: "uint256",
              name: "",
              type: "uint256",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "owner",
              type: "address",
            },
            {
              internalType: "address",
              name: "spender",
              type: "address",
            },
          ],
          name: "allowance",
          outputs: [
            {
              internalType: "uint256",
              name: "",
              type: "uint256",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "spender",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "approve",
          outputs: [
            {
              internalType: "bool",
              name: "",
              type: "bool",
            },
          ],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "account",
              type: "address",
            },
          ],
          name: "balanceOf",
          outputs: [
            {
              internalType: "uint256",
              name: "",
              type: "uint256",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [
            {
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "burn",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "account",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "burnFrom",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "decimals",
          outputs: [
            {
              internalType: "uint8",
              name: "",
              type: "uint8",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "maxSwapPerTransaction",
          outputs: [
            {
              internalType: "uint256",
              name: "",
              type: "uint256",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "name",
          outputs: [
            {
              internalType: "string",
              name: "",
              type: "string",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "owner",
          outputs: [
            {
              internalType: "address",
              name: "",
              type: "address",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "paused",
          outputs: [
            {
              internalType: "bool",
              name: "",
              type: "bool",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "renounceOwnership",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "symbol",
          outputs: [
            {
              internalType: "string",
              name: "",
              type: "string",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [],
          name: "totalSupply",
          outputs: [
            {
              internalType: "uint256",
              name: "",
              type: "uint256",
            },
          ],
          stateMutability: "view",
          type: "function",
          constant: true,
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "to",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "transfer",
          outputs: [
            {
              internalType: "bool",
              name: "",
              type: "bool",
            },
          ],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "from",
              type: "address",
            },
            {
              internalType: "address",
              name: "to",
              type: "address",
            },
            {
              internalType: "uint256",
              name: "value",
              type: "uint256",
            },
          ],
          name: "transferFrom",
          outputs: [
            {
              internalType: "bool",
              name: "",
              type: "bool",
            },
          ],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "address",
              name: "newOwner",
              type: "address",
            },
          ],
          name: "transferOwnership",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          stateMutability: "payable",
          type: "receive",
          payable: true,
        },
        {
          inputs: [],
          name: "swap",
          outputs: [],
          stateMutability: "payable",
          type: "function",
          payable: true,
        },
        {
          inputs: [],
          name: "withdraw",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "uint256",
              name: "_price",
              type: "uint256",
            },
          ],
          name: "setTokenPrice",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [
            {
              internalType: "uint256",
              name: "_max",
              type: "uint256",
            },
          ],
          name: "setMaxSwapPerTransaction",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "pause",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
        {
          inputs: [],
          name: "unpause",
          outputs: [],
          stateMutability: "nonpayable",
          type: "function",
        },
      ];
      // Button event handler

      const statusText = document.getElementById("status");

      const dtfuAmountInput = document.getElementById("amount");

      let provider, signer, contract;

      async function loadBalance() {
        const button = document.getElementById("checkBalance");
        const buttonUrl = document.getElementById("checkBalanceUrl");

        if (typeof window.ethereum !== "undefined") {
          try {
            // Show loading state
            button.innerText = "Loading DTFU Balance...";
            button.disabled = true;

            // Connect to MetaMask
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            const signer = provider.getSigner();
            const userAddress = await signer.getAddress();

            // Token Contract Details
            const contractAddress =
              "0xa7f2b206E8618D5016FFC78c9c1C6D86f6505cB2";
            const abi = DTFU_ABI;

            // Connect to Token Contract
            const contract = new ethers.Contract(
              contractAddress,
              abi,
              provider
            );

            // Get Balance and Decimals
            const balance = await contract.balanceOf(userAddress);
            const decimals = await contract.decimals();
            const formattedBalance = ethers.utils.formatUnits(
              balance,
              decimals
            );

            button.innerText = `DTFU Balance: ${formattedBalance}`;
            button.disabled = false;

            buttonUrl.href = `https://polygonscan.com/token/${contractAddress}?a=${userAddress}`;
            buttonUrl.target = "_blank";
            buttonUrl.style.cursor = "pointer";
          } catch (error) {
            console.error(error);
            button.innerText = "Error fetching balance";
            button.disabled = false;
          }
        } else {
          button.innerText = "MetaMask not detected";
        }
      }

      async function initializeContract() {
        if (!window.ethereum) {
          throw new Error("MetaMask is not installed!");
        }

        // Connect to MetaMask
        await window.ethereum.request({ method: "eth_requestAccounts" });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();

        // Connect to the contract
        contract = new ethers.Contract(DTFU_CONTRACT_ADDRESS, DTFU_ABI, signer);
      }

      async function swapTokens() {
        const statusContainer = document.getElementById("error-container");
        const statusElement = document.getElementById("status");
        const swapButton = document.getElementById("swapButton");

        statusContainer.style.display = "none"; // Hide status initially
        statusElement.textContent = ""; // Clear previous messages

        if (!window.ethereum) {
          statusElement.textContent = "MetaMask is required.";
          statusContainer.style.display = "block";
          return;
        }

        const provider = new ethers.providers.Web3Provider(window.ethereum);
        const signer = provider.getSigner();
        const contractAddress = "0xa7f2b206E8618D5016FFC78c9c1C6D86f6505cB2"; // Replace with your contract address
        const abi = DTFU_ABI;
        const contract = new ethers.Contract(contractAddress, abi, signer);

        const amountInMatic = document.getElementById("amount").value;
        if (!amountInMatic || isNaN(amountInMatic) || amountInMatic <= 0) {
          statusElement.textContent = "Please enter a valid amount.";
          statusContainer.style.display = "block";
          return;
        }

        const amountInWei = ethers.utils.parseEther(amountInMatic);

        try {
          swapButton.disabled = true;
          statusElement.textContent = "Checking balance...";
          statusContainer.style.display = "block";

          // Check user balance before proceeding
          const userAddress = await signer.getAddress();
          const balance = await provider.getBalance(userAddress);

          if (balance.lt(amountInWei)) {
            statusElement.textContent =
              "Error: Insufficient funds. You need more POL to complete this swap.";
            statusContainer.style.display = "block";
            swapButton.disabled = false;
            return;
          }
          statusElement.style.backgroundColor = "#b25e3a";
          statusElement.textContent = "Processing transaction...";
          statusContainer.style.display = "block";

          const tx = await contract.swap({ value: amountInWei });
          console.log("Transaction sent:", tx.hash);
          statusElement.style.backgroundColor = "#8a704f";
          statusElement.textContent = `Transaction sent: ${tx.hash}`;

          await tx.wait();
          console.log("Swap completed!");
          statusElement.style.backgroundColor = "#3a6d4f";
          statusElement.textContent = "Swap completed successfully!";
          statusContainer.style.display = "block";
          await loadBalance();
        } catch (error) {
          console.error("Swap failed:", error);

          let errorMessage = "Transaction failed. Please try again.";

          if (error.message.includes("insufficient funds")) {
            errorMessage =
              "Error: Insufficient funds for gas and swap. Please add more MATIC.";
          } else if (error.data?.message) {
            errorMessage = error.data.message;
          } else if (error.message) {
            errorMessage = error.message;
          }

          statusElement.textContent = errorMessage;
          statusContainer.style.display = "block";
        } finally {
          swapButton.disabled = false;
        }
      }

      async function checkIfOwner() {
        console.log("Calling Owner Check");
        const account = await signer.getAddress();
        if (account.toLowerCase() === ownerAddress.toLowerCase()) {
          console.log("Owner account detected. Showing owner-specific UI.");
          document.getElementById("ownerUI").style.display = "grid";
        } else {
          console.log("Non-owner account detected. Hiding owner-specific UI.");
          document.getElementById("ownerUI").style.display = "none";
        }
      }

      async function withdrawPOL() {
        try {
          const tx = await contract.withdraw();
          console.log("Withdrawal transaction sent:", tx);
          await tx.wait();
          console.log("POL withdrawn successfully!");
          statusText.textContent = "POL withdrawn successfully!";
        } catch (error) {
          console.error("Error withdrawing POL:", error);
          statusText.textContent = `Error: ${error.message}`;
        }
      }

      async function burnTokens() {
        console.log("hello");
        try {
          if (!window.ethereum) {
            alert("MetaMask is required");
            return;
          }

          console.log("Starting burn");

          const provider = new ethers.providers.Web3Provider(window.ethereum);
          await provider.send("eth_requestAccounts", []);
          const signer = provider.getSigner();

          const contractAddress = "0xa7f2b206E8618D5016FFC78c9c1C6D86f6505cB2"; // Your contract
          const abi = DTFU_ABI; // Use `burn`, not `burnFrom`

          const contract = new ethers.Contract(contractAddress, abi, signer);

          const burnAmount = document.getElementById("burnAmount").value;
          if (!burnAmount || isNaN(burnAmount) || burnAmount <= 0) {
            throw new Error("Please enter a valid amount.");
          }

          const amountToBurn = ethers.utils.parseEther(burnAmount);

          console.log("Burning tokens:", burnAmount);

          const tx = await contract.burn(amountToBurn);
          console.log("Transaction sent:", tx.hash);

          await tx.wait();
          console.log("Burn successful!");

          document.getElementById(
            "burnStatus"
          ).textContent = `Successfully burned ${burnAmount} tokens!`;
        } catch (error) {
          console.error("Burn failed:", error);
          document.getElementById(
            "burnStatus"
          ).textContent = `Error: ${error.message}`;
        }
      }

      withdrawButton.addEventListener("click", withdrawPOL);

      document.addEventListener("DOMContentLoaded", async () => {
        await initializeContract();
        await loadBalance();
        await checkIfOwner();
      });

      document
        .getElementById("transferDTFUButton")
        .addEventListener("click", transferDTFU);

      async function transferDTFU() {
        const statusContainer = document.getElementById("error-container");
        const statusElement = document.getElementById("status");

        statusContainer.style.display = "none"; // Hide status initially
        statusElement.textContent = ""; // Clear previous messages

        if (!window.ethereum) {
          statusElement.textContent = "MetaMask is required.";
          statusContainer.style.display = "block";
          return;
        }

        const provider = new ethers.providers.Web3Provider(window.ethereum);
        const signer = provider.getSigner();
        const contractAddress = "0xa7f2b206E8618D5016FFC78c9c1C6D86f6505cB2"; // Replace with your contract address
        const abi = DTFU_ABI;
        const contract = new ethers.Contract(contractAddress, abi, signer);

        const recipient = document.getElementById("dtfuRecipient").value.trim();
        const amount = document.getElementById("dtfuAmount").value.trim();

        if (!ethers.utils.isAddress(recipient)) {
          statusElement.textContent = "Invalid recipient address.";
          statusContainer.style.display = "block";
          return;
        }

        if (!amount || isNaN(amount) || amount <= 0) {
          statusElement.textContent = "Please enter a valid amount.";
          statusContainer.style.display = "block";
          return;
        }

        const amountInWei = ethers.utils.parseUnits(amount, 18); // Adjust decimal places as per your token

        try {
          statusElement.textContent = "Processing transfer...";
          statusContainer.style.display = "block";

          const tx = await contract.transfer(recipient, amountInWei);
          console.log("Transaction sent:", tx.hash);
          statusElement.textContent = `Transaction sent: ${tx.hash}`;

          await tx.wait();
          console.log("Transfer completed!");
          statusElement.textContent = "Transfer completed successfully!";
          statusContainer.style.display = "block";
        } catch (error) {
          console.error("Transfer failed:", error);
          statusElement.textContent =
            error.message || "Transfer failed. Please try again.";
          statusContainer.style.display = "block";
        }
      }
    </script>
  </body>
</html>
